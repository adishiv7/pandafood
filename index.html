<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panda Food Junction</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #FF6B00; /* Vibrant Orange */
            --primary-dark: #e65100;
            --primary-light: #fff3e0;
            --text-main: #1A1A1A;
            --text-sec: #666666;
            --text-light: #999999;
            --bg-body: #F8F9FA;
            --bg-card: #FFFFFF;
            --success: #00C853;
            --danger: #FF3D00;
            --radius-lg: 24px;
            --radius-md: 16px;
            --radius-sm: 12px;
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-md: 0 8px 24px rgba(0,0,0,0.08);
            --shadow-float: 0 10px 30px rgba(255, 107, 0, 0.3);
            --safe-area-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Outfit', sans-serif; background: var(--bg-body); color: var(--text-main); padding-bottom: 100px; }
        
        /* Typography Utils */
        .h1 { font-size: 24px; font-weight: 800; letter-spacing: -0.5px; }
        .h2 { font-size: 20px; font-weight: 700; }
        .h3 { font-size: 16px; font-weight: 600; }
        .text-sm { font-size: 13px; color: var(--text-sec); }
        .text-xs { font-size: 11px; color: var(--text-light); }
        .font-bold { font-weight: 700; }

        /* --- Header & Hero --- */
        .app-header {
            background: var(--bg-card);
            padding: 16px 20px;
            position: sticky; top: 0; z-index: 50;
            box-shadow: var(--shadow-sm);
            display: flex; justify-content: space-between; align-items: center;
        }
        .brand { display: flex; align-items: center; gap: 12px; }
        .brand-logo { 
            width: 40px; height: 40px; background: var(--primary); color: white; 
            border-radius: 12px; display: grid; place-items: center; font-size: 20px;
        }

        .status-widget {
            margin: 20px;
            background: linear-gradient(135deg, #2d3436, #000000);
            border-radius: var(--radius-lg);
            padding: 20px; color: white;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: var(--shadow-md);
            position: relative; overflow: hidden;
        }
        .status-widget.closed { background: linear-gradient(135deg, #ff4757, #2f3542); }
        .status-content { z-index: 2; }
        .status-icon { 
            width: 48px; height: 48px; background: rgba(255,255,255,0.15); 
            border-radius: 50%; display: grid; place-items: center; 
            backdrop-filter: blur(5px); font-size: 20px;
        }
        .status-dot {
            display: inline-block; width: 8px; height: 8px; background: var(--success); 
            border-radius: 50%; margin-right: 6px; box-shadow: 0 0 10px var(--success);
        }
        .status-widget.closed .status-dot { background: white; box-shadow: none; }

        /* --- Navigation --- */
        .nav-scroller {
            position: sticky; top: 72px; z-index: 40;
            background: var(--bg-body);
            padding: 10px 0;
            overflow-x: auto; scrollbar-width: none;
            backdrop-filter: blur(10px);
        }
        .nav-scroller::-webkit-scrollbar { display: none; }
        .nav-track { display: flex; padding: 0 20px; gap: 12px; }
        .nav-pill {
            background: white; border: 1px solid rgba(0,0,0,0.05);
            padding: 8px 16px; border-radius: 100px;
            font-size: 14px; font-weight: 500; color: var(--text-sec);
            white-space: nowrap; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            display: flex; align-items: center; gap: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
        }
        .nav-pill.active {
            background: var(--text-main); color: white;
            transform: scale(1.05); border-color: var(--text-main);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* --- Menu List --- */
        .menu-section { padding: 20px 20px 0; scroll-margin-top: 130px; }
        .section-title { margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        .section-title::after { content: ''; flex: 1; height: 1px; background: #eee; }
        
        .food-card {
            background: var(--bg-card); border-radius: var(--radius-md);
            padding: 16px; margin-bottom: 16px;
            display: flex; gap: 16px;
            border: 1px solid rgba(0,0,0,0.03);
            box-shadow: var(--shadow-sm);
            transition: transform 0.2s;
        }
        /* Desktop Grid */
        @media (min-width: 768px) {
            .menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 0 20px; }
            .food-card { margin-bottom: 0; }
        }
        @media (min-width: 1024px) { .menu-grid { grid-template-columns: repeat(3, 1fr); } }

        .food-img-placeholder {
            width: 90px; height: 90px; flex-shrink: 0;
            border-radius: var(--radius-sm);
            background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
            color: var(--primary);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 24px; position: relative;
        }
        .food-info { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        
        .diet-icon {
            position: absolute; top: 6px; left: 6px;
            width: 14px; height: 14px; background: white; border-radius: 4px;
            display: grid; place-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .icon-square { width: 10px; height: 10px; border: 1px solid; display: grid; place-items: center; border-radius: 1px; }
        .icon-dot { width: 4px; height: 4px; border-radius: 50%; }
        .veg { color: var(--success); } .veg .icon-dot { background: var(--success); }
        .nonveg { color: var(--danger); } .nonveg .icon-dot { background: var(--danger); clip-path: polygon(50% 0%, 0% 100%, 100% 100%); border-radius: 0; }
        .egg { color: #FBC02D; } .egg .icon-dot { background: #FBC02D; }

        /* Quantity Buttons */
        .add-btn {
            background: #FFF3E0; color: var(--primary);
            border: none; padding: 8px 24px; border-radius: 8px;
            font-weight: 700; font-size: 14px;
            cursor: pointer; width: fit-content; align-self: flex-start;
            transition: 0.2s;
        }
        .add-btn:active { transform: scale(0.95); }
        
        .qty-selector {
            background: var(--text-main); color: white;
            border-radius: 8px; height: 36px; min-width: 90px;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 4px;
            font-weight: 600; font-size: 14px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        .qty-btn { width: 28px; height: 28px; display: grid; place-items: center; cursor: pointer; }
        .qty-val { width: 20px; text-align: center; }

        /* Variant Modal/Select */
        .variant-group { margin-top: 8px; display: flex; flex-direction: column; gap: 8px; }
        .variant-row { 
            display: flex; justify-content: space-between; align-items: center; 
            background: var(--bg-body); padding: 6px 10px; border-radius: 8px;
        }

        /* --- Bottom Cart Bar --- */
        .bottom-cart {
            position: fixed; bottom: 20px; left: 20px; right: 20px;
            background: var(--text-main); color: white;
            padding: 16px 24px; border-radius: var(--radius-lg);
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: var(--shadow-float);
            z-index: 100; cursor: pointer;
            transform: translateY(150%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 600px; margin: 0 auto;
        }
        .bottom-cart.visible { transform: translateY(0); }
        .cart-details h4 { font-size: 14px; font-weight: 500; opacity: 0.8; text-transform: uppercase; letter-spacing: 0.5px; }
        .cart-details span { font-size: 18px; font-weight: 700; }
        .view-cart-btn { font-weight: 600; font-size: 16px; display: flex; align-items: center; gap: 8px; }

        /* --- Cart Sheet (Drawer) --- */
        .cart-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.6);
            z-index: 101; opacity: 0; pointer-events: none; transition: 0.3s;
            backdrop-filter: blur(4px);
        }
        .cart-overlay.active { opacity: 1; pointer-events: all; }
        
        .cart-drawer {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: white; z-index: 102;
            border-radius: 24px 24px 0 0;
            padding: 24px 0 0;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
            max-height: 90vh; display: flex; flex-direction: column;
            max-width: 600px; margin: 0 auto;
        }
        .cart-drawer.active { transform: translateY(0); }
        
        .drawer-header { padding: 0 24px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .drawer-body { overflow-y: auto; padding: 20px 24px; flex: 1; }
        .drawer-footer { padding: 20px 24px; border-top: 1px solid #eee; background: white; padding-bottom: calc(20px + var(--safe-area-bottom)); }

        .cart-item-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .item-row-left { display: flex; align-items: center; gap: 12px; }
        
        .whatsapp-btn {
            width: 100%; background: #25D366; color: white;
            border: none; padding: 16px; border-radius: 16px;
            font-size: 16px; font-weight: 700;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
            cursor: pointer;
        }

        /* --- Empty States & Loaders --- */
        .shimmer { animation: shimmer 2s infinite linear; background: linear-gradient(to right, #f6f7f8 0%, #edeef1 20%, #f6f7f8 40%, #f6f7f8 100%); background-size: 1000px 100%; }
        @keyframes shimmer { 0% { background-position: -1000px 0; } 100% { background-position: 1000px 0; } }

    </style>
</head>
<body>

    <!-- Header -->
    <header class="app-header">
        <div class="brand">
            <div class="brand-logo"><i class="fa-solid fa-panda-bear"></i></div>
            <div>
                <h1 class="h3" style="line-height: 1.1;">Panda Food</h1>
                <p class="text-xs">Junction</p>
            </div>
        </div>
        <a href="tel:+919693146705" style="width: 40px; height: 40px; border-radius: 50%; border: 1px solid #eee; display: grid; place-items: center; color: var(--text-main); text-decoration: none;">
            <i class="fa-solid fa-phone"></i>
        </a>
    </header>

    <!-- Status Widget -->
    <div id="status-widget" class="status-widget">
        <div class="status-content">
            <div class="text-xs" style="opacity: 0.8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 4px;">Current Status</div>
            <h2 class="h2" style="margin-bottom: 4px;" id="status-title">Checking...</h2>
            <p class="text-sm" style="color: rgba(255,255,255,0.7);" id="status-desc">--</p>
        </div>
        <div class="status-icon">
            <i class="fa-regular fa-clock"></i>
        </div>
    </div>

    <!-- Sticky Category Nav -->
    <nav class="nav-scroller">
        <div class="nav-track" id="category-track">
            <!-- Injected by JS -->
        </div>
    </nav>

    <!-- Menu Area -->
    <main class="container" id="main-content">
        <!-- Injected by JS -->
    </main>

    <!-- Sticky Bottom Cart Bar -->
    <div id="bottom-cart" class="bottom-cart" onclick="openCart()">
        <div class="cart-details">
            <h4 id="cart-count-label">0 ITEMS</h4>
            <span id="cart-total-label">â‚¹0</span>
        </div>
        <div class="view-cart-btn">
            View Cart <i class="fa-solid fa-chevron-right" style="font-size: 12px;"></i>
        </div>
    </div>

    <!-- Cart Drawer -->
    <div class="cart-overlay" id="cart-overlay" onclick="closeCart()"></div>
    <div class="cart-drawer" id="cart-drawer">
        <div class="drawer-header">
            <h2 class="h2">Your Order</h2>
            <div onclick="closeCart()" style="padding: 8px; cursor: pointer;"><i class="fa-solid fa-xmark" style="font-size: 20px;"></i></div>
        </div>
        <div class="drawer-body" id="cart-items-body">
            <!-- Items injected here -->
        </div>
        <div class="drawer-footer">
            <div style="display: flex; justify-content: space-between; margin-bottom: 16px;">
                <span class="h3">Total to Pay</span>
                <span class="h2" style="color: var(--primary);" id="drawer-total">â‚¹0</span>
            </div>
            <button class="whatsapp-btn" onclick="checkout()">
                <i class="fa-brands fa-whatsapp" style="font-size: 20px;"></i> Place Order
            </button>
            <p class="text-xs" style="text-align: center; margin-top: 12px; color: var(--text-light);">
                Order will be sent via WhatsApp
            </p>
        </div>
    </div>

    <script>
        // --- Data ---
        const categories = [
            { id: 'rolls', name: 'Rolls', icon: 'fa-scroll' },
            { id: 'rice', name: 'Rice', icon: 'fa-bowl-rice' },
            { id: 'chowmein', name: 'Chowmein', icon: 'fa-bacon' },
            { id: 'more', name: 'Starters', icon: 'fa-fire' }
        ];

        const menuData = {
            rolls: [
                { id: 'r1', name: 'Single Egg Roll', price: 45, type: 'egg', short: 'Classic' },
                { id: 'r2', name: 'Double Egg Roll', price: 50, type: 'egg', short: 'Double' },
                { id: 'r3', name: 'Veg Roll', price: 40, type: 'veg', short: 'Veggie' },
                { id: 'r4', name: 'Paneer Roll', price: 60, type: 'veg', short: 'Paneer' },
                { id: 'r5', name: '1 Egg Chicken Roll', price: 80, type: 'nonveg', short: 'Chicken' },
                { id: 'r6', name: '2 Egg Chicken Roll', price: 90, type: 'nonveg', short: 'Dbl Chick' },
                { id: 'r7', name: 'Chicken Roll (No Egg)', price: 70, type: 'nonveg', short: 'Just Chick' }
            ],
            rice: [
                { id: 'ri1', name: 'Fried Rice', priceF: 80, priceH: 50, type: 'veg', short: 'Fried' },
                { id: 'ri2', name: 'Egg Fried Rice', priceF: 100, priceH: 60, type: 'egg', short: 'Egg Fried' },
                { id: 'ri3', name: 'Chicken Fried Rice', priceF: 130, priceH: 70, type: 'nonveg', short: 'Chick Rice' },
                { id: 'ri4', name: 'Paneer Fried Rice', priceF: 120, priceH: 70, type: 'veg', short: 'Paneer Rice' },
                { id: 'ri5', name: 'Mix Fried Rice', priceF: 150, priceH: 80, type: 'veg', short: 'Mix Rice' },
                { id: 'ri6', name: 'Mix Rice (Non-Veg)', priceF: 150, priceH: 80, type: 'nonveg', short: 'Mix NV' }
            ],
            chowmein: [
                { id: 'c1', name: 'Veg Chowmein', priceF: 80, priceH: 50, type: 'veg', short: 'Veg' },
                { id: 'c2', name: 'Paneer Chowmein', priceF: 120, priceH: 70, type: 'veg', short: 'Paneer' },
                { id: 'c3', name: 'Egg Chowmein', priceF: 100, priceH: 60, type: 'egg', short: 'Egg' },
                { id: 'c4', name: 'Chicken Chowmein', priceF: 130, priceH: 70, type: 'nonveg', short: 'Chicken' },
                { id: 'c5', name: 'Mix Chowmein', priceF: 150, priceH: 80, type: 'veg', short: 'Mix' },
                { id: 'c6', name: 'Mix Chowmein (NV)', priceF: 150, priceH: 80, type: 'nonveg', short: 'Mix NV' }
            ],
            more: [
                { id: 'm1', name: 'Veg Manchurian', priceF: 100, priceH: 60, type: 'veg', short: 'Manchurian' },
                { id: 'm2', name: 'Paneer Chilli', priceF: 160, priceH: 80, type: 'veg', short: 'Pan. Chilli' },
                { id: 'm3', name: 'Baby Corn Chilli', priceF: 150, priceH: 80, type: 'veg', short: 'Baby Corn' },
                { id: 'm4', name: 'Mushroom Chilli', priceF: 150, priceH: 80, type: 'veg', short: 'Mushroom' },
                { id: 'm5', name: 'Chicken Chilli (BL)', priceF: 160, priceH: 85, type: 'nonveg', short: 'Chick Chilli' },
                { id: 'm6', name: 'Lachha Paratha', price: 20, type: 'veg', short: 'Paratha' }
            ]
        };

        // --- State ---
        let cart = {};
        let restaurantOpen = false;

        // --- Init ---
        document.addEventListener('DOMContentLoaded', () => {
            initTime();
            renderNav();
            renderMenu();
            
            // Scroll Spy
            window.addEventListener('scroll', () => {
                let current = '';
                categories.forEach(cat => {
                    const section = document.getElementById(cat.id);
                    if (section && window.scrollY >= (section.offsetTop - 150)) {
                        current = cat.id;
                    }
                });
                if(current) setActiveNav(current);
            });
        });

        // --- Logic ---
        function initTime() {
            const check = () => {
                const now = new Date();
                const mins = now.getHours() * 60 + now.getMinutes();
                const open = 15 * 60 + 30; // 3:30 PM
                const close = 22 * 60 + 30; // 10:30 PM
                
                restaurantOpen = mins >= open && mins <= close;
                
                const widget = document.getElementById('status-widget');
                const title = document.getElementById('status-title');
                const desc = document.getElementById('status-desc');

                if (restaurantOpen) {
                    widget.classList.remove('closed');
                    title.innerHTML = '<span class="status-dot"></span> Open Now';
                    desc.innerText = 'Closing at 10:30 PM';
                } else {
                    widget.classList.add('closed');
                    title.innerHTML = '<span class="status-dot"></span> Closed';
                    desc.innerText = 'Opens daily at 3:30 PM';
                }
            };
            check();
            setInterval(check, 60000);
        }

        function renderNav() {
            const track = document.getElementById('category-track');
            track.innerHTML = categories.map((cat, index) => `
                <a href="#${cat.id}" class="nav-pill ${index === 0 ? 'active' : ''}" id="nav-${cat.id}" onclick="setActiveNav('${cat.id}')">
                    <i class="fa-solid ${cat.icon}"></i> ${cat.name}
                </a>
            `).join('');
        }

        function setActiveNav(id) {
            document.querySelectorAll('.nav-pill').forEach(el => el.classList.remove('active'));
            const el = document.getElementById(`nav-${id}`);
            if(el) {
                el.classList.add('active');
                el.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
        }

        function getDietIcon(type) {
            return `<div class="diet-icon ${type}"><div class="icon-square"><div class="icon-dot"></div></div></div>`;
        }

        // Gradient generator based on item name for consistency
        function getGradient(name) {
            const colors = [
                'linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%)',
                'linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)',
                'linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%)',
                'linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%)',
                'linear-gradient(120deg, #f6d365 0%, #fda085 100%)'
            ];
            const index = name.length % colors.length;
            return colors[index];
        }

        function renderMenu() {
            const container = document.getElementById('main-content');
            
            categories.forEach(cat => {
                const items = menuData[cat.id];
                
                const sectionHtml = `
                    <div id="${cat.id}" class="menu-section">
                        <h3 class="section-title h2">${cat.name}</h3>
                        <div class="menu-grid">
                            ${items.map(item => createCard(item)).join('')}
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', sectionHtml);
            });
        }

        function createCard(item) {
            const isVar = item.price === undefined;
            const grad = getGradient(item.name);
            
            // Determine initial button state (Add or Qty controls)
            // Note: Since we have variants, main render always shows "Add" buttons inside the variant rows or main add
            // For simple items, we can swap content.
            
            let actionHtml = '';
            
            if (isVar) {
                actionHtml = `
                    <div class="variant-group">
                        <div class="variant-row">
                            <span class="text-xs font-bold">FULL</span>
                            <span class="font-bold">â‚¹${item.priceF}</span>
                            <div id="btn-${item.id}-F">
                                ${getBtnHtml(item.id, 'F')}
                            </div>
                        </div>
                        <div class="variant-row">
                            <span class="text-xs font-bold">HALF</span>
                            <span class="font-bold">â‚¹${item.priceH}</span>
                            <div id="btn-${item.id}-H">
                                ${getBtnHtml(item.id, 'H')}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                actionHtml = `
                    <div class="h2 font-bold" style="margin: 8px 0;">â‚¹${item.price}</div>
                    <div id="btn-${item.id}">
                        ${getBtnHtml(item.id)}
                    </div>
                `;
            }

            return `
                <div class="food-card">
                    <div class="food-img-placeholder" style="background: ${grad}">
                        ${getDietIcon(item.type)}
                        <i class="fa-solid fa-utensils" style="color: rgba(0,0,0,0.5); font-size: 28px;"></i>
                        <div class="text-xs font-bold" style="margin-top: 4px; color: rgba(0,0,0,0.6);">${item.short}</div>
                    </div>
                    <div class="food-info">
                        <div class="h3" style="line-height: 1.2;">${item.name}</div>
                        ${actionHtml}
                    </div>
                </div>
            `;
        }

        function getBtnHtml(id, size = null) {
            const key = size ? `${id}-${size}` : id;
            const qty = cart[key]?.quantity || 0;
            
            if (qty > 0) {
                return `
                    <div class="qty-selector">
                        <div class="qty-btn" onclick="updateQty('${id}', '${size || ''}', -1)">-</div>
                        <div class="qty-val">${qty}</div>
                        <div class="qty-btn" onclick="updateQty('${id}', '${size || ''}', 1)">+</div>
                    </div>
                `;
            } else {
                return `
                    <button class="add-btn" onclick="updateQty('${id}', '${size || ''}', 1)">
                        ADD
                    </button>
                `;
            }
        }

        // --- Cart Logic ---
        function findItem(id) {
            for (const cat in menuData) {
                const found = menuData[cat].find(i => i.id === id);
                if (found) return found;
            }
        }

        function updateQty(id, size, delta) {
            const item = findItem(id);
            const key = size ? `${id}-${size}` : id;
            const price = size ? (size === 'F' ? item.priceF : item.priceH) : item.price;
            const name = size ? `${item.name} (${size === 'F' ? 'Full' : 'Half'})` : item.name;

            if (!cart[key]) cart[key] = { ...item, displayName: name, price, quantity: 0, sizeKey: size, coreId: id };
            
            cart[key].quantity += delta;
            if (cart[key].quantity <= 0) delete cart[key];

            // Re-render button logic for this specific item
            const containerId = size ? `btn-${id}-${size}` : `btn-${id}`;
            const el = document.getElementById(containerId);
            if (el) el.innerHTML = getBtnHtml(id, size || null);

            updateCartUI();
        }

        function updateCartUI() {
            const items = Object.values(cart);
            const count = items.reduce((a, b) => a + b.quantity, 0);
            const total = items.reduce((a, b) => a + (b.price * b.quantity), 0);

            // Bottom Bar
            const bar = document.getElementById('bottom-cart');
            if (count > 0) {
                bar.classList.add('visible');
                document.getElementById('cart-count-label').innerText = `${count} ITEM${count > 1 ? 'S' : ''}`;
                document.getElementById('cart-total-label').innerText = `â‚¹${total}`;
            } else {
                bar.classList.remove('visible');
                closeCart(); // Auto close if empty
            }
            
            document.getElementById('drawer-total').innerText = `â‚¹${total}`;
        }

        function openCart() {
            document.getElementById('cart-overlay').classList.add('active');
            document.getElementById('cart-drawer').classList.add('active');
            renderDrawerItems();
        }

        function closeCart() {
            document.getElementById('cart-overlay').classList.remove('active');
            document.getElementById('cart-drawer').classList.remove('active');
        }

        function renderDrawerItems() {
            const container = document.getElementById('cart-items-body');
            const items = Object.values(cart);
            
            if (items.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding: 20px;">Cart is empty</div>';
                return;
            }

            container.innerHTML = items.map(item => `
                <div class="cart-item-row">
                    <div class="item-row-left">
                        ${getDietIcon(item.type)}
                        <div>
                            <div class="h3" style="font-size: 14px;">${item.displayName}</div>
                            <div class="text-xs">â‚¹${item.price}</div>
                        </div>
                    </div>
                    <div class="qty-selector" style="box-shadow: none; background: #eee; color: black;">
                        <div class="qty-btn" onclick="updateDrawerQty('${item.coreId}', '${item.sizeKey}', -1)">-</div>
                        <div class="qty-val">${item.quantity}</div>
                        <div class="qty-btn" onclick="updateDrawerQty('${item.coreId}', '${item.sizeKey}', 1)">+</div>
                    </div>
                </div>
            `).join('');
        }

        function updateDrawerQty(id, size, delta) {
            // Update state
            updateQty(id, size === 'null' ? null : size, delta);
            // Re-render drawer to reflect changes immediately
            renderDrawerItems();
        }

        function checkout() {
            if (!restaurantOpen) {
                alert("Sorry, the restaurant is currently closed!");
                return;
            }
            
            const items = Object.values(cart);
            let msg = "*New Order from App* ðŸ¼\n\n";
            items.forEach(i => {
                msg += `${i.quantity} x ${i.displayName} = â‚¹${i.price * i.quantity}\n`;
            });
            const total = items.reduce((a, b) => a + (b.price * b.quantity), 0);
            msg += `\n*Total Bill: â‚¹${total}*`;
            
            window.open(`https://wa.me/919693146705?text=${encodeURIComponent(msg)}`, '_blank');
        }

    </script>
</body>
</html>
